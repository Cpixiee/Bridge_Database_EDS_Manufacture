services:
  api:
    build: .
    container_name: bridge_db_api
    ports:
      - "8000:8000"  # Changed from 2026:8000 to match user's expected port
    environment:
      # DB QA (ubah jika perlu)
      # Opsi DB_HOST (coba satu per satu jika tidak berhasil):
      # 1. host.docker.internal - untuk akses host dari container (sudah dikonfigurasi di extra_hosts)
      # 2. 172.17.0.1 - Docker bridge gateway (default)
      # 3. localhost atau 127.0.0.1 - jika MySQL hanya listen di localhost (perlu network_mode: host)
      DB_HOST: "host.docker.internal"  # Coba ini dulu
      DB_PORT: "3306"
      DB_USER: "root"
      DB_PASSWORD: "cyber"  # Updated from beny1234 to match phpMyAdmin
      DB_NAME: "qa"
    restart: unless-stopped
    extra_hosts:
      - "host.docker.internal:host-gateway"  # Untuk akses host dari container (Linux)

